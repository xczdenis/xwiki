# XWiki

[XWiki](https://xwiki.org/) - это база знаний.

## Запуск

В Windows все команды выполняются в GitBash!

Создать файл `.env`:
```shell
cp .env.template .env
```

Справка по всем командам:
```shell
./make.sh --help
```

Запустить:
```shell
./make.sh run
```

Остановить:
```shell
./make.sh down
```

## Бекапы и восстановление

Чтобы создать бекапы докер-томов выполните:
```shell
./make.sh backup
```

Бекапы создаются в папке [backup](backup). Каждый бекап создает каталог с названием в формате `GGGG_MM_DD_HH_MM`. В каждом таком каталоге 2 файла:
1. `xwiki.tar.gz`: бекап тома данных xwiki
2. `pg.tar.gz`: бекап тома данных Postgres

Чтобы восстановить докер-тома из бекапов, тома должны существовать. Если сервис еще ни разу не запускался, то томов создано не будет и при выполнении операции восстановления будет ошибка. 

Перед выполнением операции восстановления из бекапов нужно как минимум 1 раз запустить сервис и сразу остановить его, чтобы создались тома:
```shell
./make.sh run
./make.sh down
```

После этого тома будут созданы.

Для восстановления томов из бекапов перенесите 2 файла `xwiki.tar.gz` и `pg.tar.gz` из нужного каталога бекапа в папку `backup`. Затем выполните команду:
```shell
./make.sh restore
```